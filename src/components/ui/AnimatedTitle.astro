---
/**
 * AnimatedTitle Component
 *
 * Rendert einen animierten Titel mit optionaler Zeilen-Animation.
 * Ersetzt duplizierten Code aus Hero, Features, Brands und Headline.
 *
 * Features:
 * - Automatisches Splitting bei <br/> Tags
 * - Alternierende Links/Rechts-Animation pro Zeile
 * - Konfigurierbare Heading-Level (h1-h6)
 * - Unterstützung für HTML in Titeln (set:html)
 *
 * @example
 * <AnimatedTitle
 *   title="Meine<br/>Überschrift"
 *   headingLevel="h1"
 *   class="text-5xl"
 * />
 */

import { twMerge } from 'tailwind-merge';

interface Props {
  /** Titel-Text, kann <br/> für Zeilenumbrüche enthalten */
  title: string;
  /** HTML-Heading-Level (default: h2) */
  headingLevel?: 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6';
  /** Zusätzliche CSS-Klassen */
  class?: string;
  /** Aktiviert Zeilen-Animation (default: true) */
  animateLines?: boolean;
  /** Basis-Delay für Animationen in ms (default: 0) */
  baseDelay?: number;
  /** Delay-Inkrement pro Zeile in ms (default: 150) */
  delayIncrement?: number;
}

const {
  title,
  headingLevel = 'h2',
  class: className = '',
  animateLines = true,
  baseDelay = 0,
  delayIncrement = 150,
} = Astro.props;

const HeadingTag = headingLevel;
const titleLines = title ? title.split('<br/>').filter((line) => line.trim()) : [];
const hasMultipleLines = titleLines.length > 1;
---

<HeadingTag class={twMerge('leading-tighter font-heading tracking-tighter', className)}>
  {
    animateLines && hasMultipleLines ? (
      titleLines.map((line, index) => (
        <span
          data-animate
          data-anim-type="decipher"
          data-anim-delay={baseDelay + index * delayIncrement}
          set:html={line}
          class="block"
        />
      ))
    ) : (
      <span data-animate data-anim-type="decipher" data-anim-delay={baseDelay} set:html={title} />
    )
  }
</HeadingTag>
